"use strict";const searchResult=document.querySelector(".js-searchResult"),apiUrl="https://api.jikan.moe/v3/search/anime?q=",searchInput=document.querySelector(".js-input"),searchBtn=document.querySelector(".js-searchBtn"),resetInputBtn=document.querySelector(".js-resetInput"),favList=document.querySelector(".js-favList"),resetFavsBtn=document.querySelector(".js-resetFavsBtn"),animesListForFavs=document.querySelectorAll(".js_addToFav");let data=[],dataFavorites=[];function getInputValue(){return searchInput.value.toLowerCase()}function handleSearchButton(t){t.preventDefault(),getResultsFromAPI()}function getResultsFromAPI(){let t=getInputValue();t.length>2?fetch(`${apiUrl}${t}`).then(t=>t.json()).then(t=>{data=t.results,0===data.length?searchResult.innerHTML="Ups!! No animes with that name. Try a different one!":renderAnimeList()}):searchResult.innerHTML="Please type at least 3 characters to start searching"}function renderAnime(t){let e="";e=void 0!==dataFavorites.find(e=>e.title===t.title)?"highlight":"",searchResult.innerHTML+=`<li  class=" js_addToFav ${e}" data-title="${t.title}" >\n\t<img src="${t.image_url}" data-title="${t.title}></img>\n\t<p class="">${t.title}</p>\n\t\t</li>`}function renderAnimeList(){searchResult.innerHTML="";for(const t of data)renderAnime(t);const t=document.querySelectorAll(".js_addToFav");for(const e of t)e.addEventListener("click",handleAddToFavs)}function handleAddToFavs(t){const e=t.currentTarget.dataset.title,a=data.find(t=>t.title===e);void 0===dataFavorites.find(t=>t.title===e)?dataFavorites.push(a):dataFavorites=dataFavorites.filter(t=>t.title!==e),toggleFavClass(t),saveFavsInLS(),renderAllFavs()}function toggleFavClass(t){t.currentTarget.classList.toggle("highlight")}function renderAllFavs(){favList.innerHTML="";for(const t of dataFavorites)renderFavsItem(t);const t=document.querySelectorAll(".js-favBtn");for(const e of t)e.addEventListener("click",handleDeleteFromFavs)}function renderFavsItem(t){favList.innerHTML+=`<li  class="js_addToFav " data-title="${t.title}" >\n\t\t\t<img src="${t.image_url}"></img>\n\t\t\t<p class="">${t.title}</p>\n\t\t\t</li>\n\t\t\t<button class="favBtn js-favBtn" data-title="${t.title}">Delete Favorite</button>`}function handleDeleteFromFavs(t){const e=t.currentTarget.dataset.title,a=dataFavorites.find(t=>t.title===e);dataFavorites=dataFavorites.filter(t=>t.title!==a.title),renderAllFavs(),renderAnimeList(),saveFavsInLS()}function handleResetInput(t){t.preventDefault(),searchInput.value="",searchResult.innerHTML=""}function handleResetFavs(t){dataFavorites=[],renderAllFavs(),renderAnimeList(),saveFavsInLS()}function saveFavsInLS(){localStorage.setItem("favAnimes",JSON.stringify(dataFavorites))}function getFavsFromLS(){const t=localStorage.getItem("favAnimes");null===t?dataFavorites=[]:(dataFavorites=JSON.parse(t),renderAllFavs())}searchBtn.addEventListener("click",handleSearchButton),resetInputBtn.addEventListener("click",handleResetInput),resetFavsBtn.addEventListener("click",handleResetFavs),getFavsFromLS();